<%= link_to "New Product", new_product_path %>
<h2> Products </h2>
<table>
  <tr>
    <th>Name</th>
    <th>Price</th>
    <th>Description</th>
    <th>Inventory</th>
  </tr>
  <% @products.each do |product| %>
  <tr>
    <td><%=product.name %></td>
    <td><%=product.price %></td>
    <td id="bodi-<%=product.id %>"><%= truncate product.description %><button class="js-more" data-id="<%= product.id%>">More Info</button></td>
    <td id="inv-<%=product.name %>"></td>
  </tr>
  <% end %>
</table>
<script type="text/javascript" charset="utf-8">
$(function () {
  $(".js-more").on('click', function() {
    var id = $(this).data("id");

    $.get("/products/" + id + "/description", function(description) {
			$.get("/products/" + id + "/inventory", function(inventory) {
				var inventoryText = "<strong>Available</strong>";
			 if(inventory === "false"){
				 inventoryText = "<strong>Sold Out</strong>";
			 }
			 var descriptionText = "<p>" + description + "</p><p>" + inventoryText + "</p>";
			 $("#product-" + id).html(descriptionText);

			})
    });
  });
});
</script>
